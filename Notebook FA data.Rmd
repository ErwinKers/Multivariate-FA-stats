---
title: "R Multivariate statistics: FA data"
author: "Erwin Kers"
date: 04-10-2021
output: html_notebook
---
## Goal

I'm trying to reproduce the graph published in: 

*Grosbois, G., Mariash, H., Schneider, T., & Rautio, M. (2017). Under-ice availability of phytoplankton lipids is key to freshwater zooplankton winter survival. Scientific reports, 7(1), 1-11.*

The pdf is included in this github repository. However I have not yet succeeded.

### First try on the raw data

I have grouped the data in excel (SAFA, MUFA, PUFA, n-3,n-6 and the biomarkers for phytoplankton, bacteria, terrestrial) as indicated in their paper.
```{r}
group <- read_excel("C:/Users/Erwin kers/OneDrive/UIT/BIO-3524/practice data/Github/Multivariate-FA-stats/grouping.xlsx")
View(group)

groupPR <- prcomp(group[c(44:51)], center = T, scale = T)
fviz_pca_biplot(groupPR, geom.ind = "point", pointshape = 21, 
             pointsize = 2, 
             fill.ind = group$Species, 
             col.ind = "black", 
             palette = "jco", 
             addEllipses = TRUE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "Species") +
  ggtitle("2D PCA-plot from FA dataset") +
  theme(plot.title = element_text(hjust = 0.5))
```

### As you can see I do not get the same results

Here I used the data but than as a percentage of total FA.
Note i have changed the colors to match their colors for easier comparison

```{r}
######## Percentage----


percent <- read_excel("C:/Users/Erwin Kers/OneDrive/UIT/BIO-3524/practice data/Github/Multivariate-FA-stats/percentage FA.xlsx")

## not the same result, did they remove outliers?

percentPR <- prcomp(percent[c(44:51)], center = T, scale = T)
fviz_pca_biplot(percentPR, geom.ind = "point",
                
                pointshape = 22, 
                pointsize = 2, 
                fill.ind = percent$Species, 
                col.ind = "black", 
                palette = c("yellow", "green","red", "blue", "white"), 
                addEllipses = F,
                label = "var",
                col.var = "black",
                repel = F,
                legend.title = "Species") +
  ggtitle("2D PCA-plot from FA dataset") +
  theme(plot.title = element_text(hjust = 0.5))
```

